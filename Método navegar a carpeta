import java.awt.*;
import java.awt.datatransfer.StringSelection;
import java.awt.event.KeyEvent;

@When("^Agentsit navega hasta la carpeta Downloads$")
public void navegarHastaDownloads() throws Exception {
    // Obtener carpeta Downloads de forma dinámica
    String downloadsPath = System.getProperty("user.home") + "\\Downloads";
    System.out.println("Navegando a carpeta: " + downloadsPath);

    // Copiar al portapapeles
    StringSelection ss = new StringSelection(downloadsPath);
    Toolkit.getDefaultToolkit().getSystemClipboard().setContents(ss, null);

    Robot robot = new Robot();
    robot.delay(1000); // pequeño delay para dar tiempo a que el diálogo esté activo

    // Alt+D -> enfoca la barra de dirección del diálogo
    robot.keyPress(KeyEvent.VK_ALT);
    robot.keyPress(KeyEvent.VK_D);
    robot.keyRelease(KeyEvent.VK_D);
    robot.keyRelease(KeyEvent.VK_ALT);

    robot.delay(500);

    // Ctrl+V -> pega la ruta de Downloads
    robot.keyPress(KeyEvent.VK_CONTROL);
    robot.keyPress(KeyEvent.VK_V);
    robot.keyRelease(KeyEvent.VK_V);
    robot.keyRelease(KeyEvent.VK_CONTROL);

    robot.delay(500);

    // Enter -> abre la carpeta
    robot.keyPress(KeyEvent.VK_ENTER);
    robot.keyRelease(KeyEvent.VK_ENTER);

    System.out.println("Carpeta Downloads abierta en el diálogo.");
}
