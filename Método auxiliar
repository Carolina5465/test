import org.json.JSONObject;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

private Map<String, String> parseFlatJsonToMap(String json) {
    Map<String, String> map = new HashMap<>();
    JSONObject obj = new JSONObject(json);

    Iterator<String> keys = obj.keys();
    while (keys.hasNext()) {
        String key = keys.next();
        Object value = obj.get(key);
        map.put(key, value != null ? value.toString() : null);
    }
    return map;
}
